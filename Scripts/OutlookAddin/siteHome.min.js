function ShowError(e){var t="<p>"+e+"</p>";$("#errorList").html(""),$("#errorList").append(t),$("#errorContainer").css("display","inline-block"),$(window).scrollTop($("#errorContainer").position().top)}function ShowTimeEntryDetailsError(e){var t="<p>"+e+"</p>";$("#timeEntryDetailsErrorContainer").css("display","inline-block"),$("#timeEntryDetailsErrorContainer").find("#errorList").html(""),$("#timeEntryDetailsErrorContainer").find("#errorList").append(t),$(window).scrollTop($("#homePageContainer").position().top)}function HideError(e){$(e).parent("div.alert").find("#errorList").html(""),$(e).parent("div.alert").css("display","none")}function HideAllError(){$("#timeEntryDetailsErrorContainer").css("display","none"),$("#errorContainer").css("display","none")}function LoginRequest(){try{HideLoginError(),$("#loadingImageLogin").show();var e=$("#inputCompany").val().trim(),t=$("#inputUserName").val().trim(),a=$("#inputPassword").val().trim();""!=e&&""!=t&&""!=a?$.ajax({type:"POST",url:gl_ServicePath+"/AuthenticateUser",data:'{"company": "'+e+'", "username": "'+t+'", "password": "'+a+'"}',contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){if(e.d){var t=jQuery.parseJSON(e.d);t.hasOwnProperty("StatusCode")&&500==t.StatusCode&&(ShowLoginError(t.ErrorMessage),$("#loadingImageLogin").hide())}else window.location.reload()},error:function(e){ShowLoginError("Error on login."),$("#loadingImageLogin").hide()}}):(ShowLoginError("Company Name/Email/Password cannot be empty."),$("#loadingImageLogin").hide())}catch(o){ShowLoginError("Error on login."),$("#loadingImageLogin").hide()}}function ShowLoginError(e){var t="<p>"+e+"</p>";$("#loginErrorList").html(""),$("#loginErrorList").append(t),$("#loginErrorContainer").show(),$("#inputPassword").val("")}function HideLoginError(){$("#loginErrorList").html(""),$("#loginErrorContainer").hide()}function LoadWeekHours(e,t){try{e&&($("#weeklyDatePicker").datetimepicker({format:"MMMM DD,YYYY",defaultDate:SetWeekDate(moment())}),$("#weeklyDatePicker"));var a=$("#startDate").val(),o=$("#endDate").val();$.ajax({type:"POST",url:gl_ServicePath+"/GetTimeEntriesDailyTotal",data:'{"start": "'+a+'", "end": "'+o+'"}',contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){var o=jQuery.parseJSON(a.d);if(o.hasOwnProperty("StatusCode")&&500==o.StatusCode)ShowError(o.ErrorMessage);else{var r=o;if($("#weeklyHours").html(""),_.each(r.DailyHoursList,function(e,t,a){var o=_.template($("#weeklyHoursTemplate").text())(e);$("#weeklyHours").append(o)}),""==t){if(void 0!=outlookItem&&"appointment"==outlookItem.itemType&&e){var n=moment($("#isCalenderEntry").attr("data-date"),"MM/DD/YYYY").day()+1;$("#weeklyHours").find(".weekly_day:nth-child("+n+")").addClass("selected"),$("#weekDayName").find(".day_weekly_block.selected").removeClass("selected");var i=moment($("#isCalenderEntry").attr("data-date"),"MM/DD/YYYY").format("dddd");$("#"+i).addClass("selected")}else if(e){var l=moment().day()+1;$("#"+moment().format("dddd")).addClass("selected"),$("#weeklyHours").find(".weekly_day:nth-child("+l+")").addClass("selected")}else $("#weeklyHours").find(".weekly_day:nth-child(2)").addClass("selected");e||LoadSingleDayEntry(!1)}else $("#weeklyHours").find(".weekly_day[data-value='"+t+"']").addClass("selected")}},error:function(e){ShowError("Error loading data.")}})}catch(r){ShowError("Error loading data.")}}function LoadTimeEntryViews(){try{$("#tabs").hide(),$("#content").hide(),$("#loadingImage").show(),$.get("TimeEntry/TimeEntryDetails/TimeEntryDetails.html",function(e){$("#timeEntryDetailsContainer").html(e),LoadClients(),DisplayMeetingDivs(),SetBillableCheckBoxVisibility()}),$.get("TimeEntry/TimeEntries/TimeEntries.html",function(e){$("#timeEntriesContainer").html(e)})}catch(e){ShowError("Error loading data.")}}function Logoff(){$("#homePageContainer").hide(),$("#loadingImageHome").show();try{$.ajax({type:"POST",url:gl_ServicePath+"/LogOff",data:"",contentType:"application/json; charset=utf-8",dataType:"json",success:function(){window.location.reload()},error:function(e){ShowError("Error during logoff."),$("#homePageContainer").show(),$("#loadingImageHome").hide()}})}catch(e){ShowError("Error during logoff."),$("#homePageContainer").show(),$("#loadingImageHome").hide()}}function SetWeekDate(e){try{void 0!=outlookItem&&"appointment"==outlookItem.itemType&&(e=moment($("#isCalenderEntry").attr("data-date"),"MM/DD/YYYY"));var t=moment(e,"MMMM DD,YYYY").day(0).format("DD"),a=moment(e,"MMMM DD,YYYY").day(6).format("DD"),o=monthNames[moment(e,"MMMM DD,YYYY").day(0).format("MM")-1],r=moment(e,"MMMM DD,YYYY").day(6).format("YYYY");$("#startDate").val(moment(e,"MM/DD/YYYY").day(0).format("MM/DD/YYYY")),$("#endDate").val(moment(e,"MM/DD/YYYY").day(6).format("MM/DD/YYYY")),$("#previousDate").val(moment(e,"MMMM DD,YYYY").day(-1)),$("#nextDate").val(moment(e,"MMMM DD,YYYY").day(7)),$("#month").text(o),$("#dates").text(t+"-"+a),$("#year").text(r)}catch(n){ShowError("Error loading data.")}}function SetNextWeek(){try{var e=moment($("#nextDate").val()),t=moment(e,"MMMM DD,YYYY").day(0).format("DD"),a=moment(e,"MMMM DD,YYYY").day(6).format("DD"),o=monthNames[moment(e,"MMMM DD,YYYY").day(0).format("MM")-1],r=moment(e,"MMMM DD,YYYY").day(6).format("YYYY");$("#startDate").val(moment(e,"MM/DD/YYYY").day(0).format("MM/DD/YYYY")),$("#endDate").val(moment(e,"MM/DD/YYYY").day(6).format("MM/DD/YYYY")),$("#previousDate").val(moment(e,"MMMM DD,YYYY").day(-1)),$("#nextDate").val(moment(e,"MMMM DD,YYYY").day(7)),$("#month").text(o),$("#dates").text(t+"-"+a),$("#year").text(r),$("#timeEntryId").val(""),timeEntriesData="",$("#btnSave").val("Enter Time"),RemoveControlErrorStyle(),LoadWeekHours(!1,""),DisplayMeetingDivs(),LoadCustomTemplatesWithDefaultData()}catch(n){ShowError("Error loading data.")}}function SetPreviousWeek(){try{var e=moment($("#previousDate").val()),t=moment(e,"MMMM DD,YYYY").day(0).format("DD"),a=moment(e,"MMMM DD,YYYY").day(6).format("DD"),o=monthNames[moment(e,"MMMM DD,YYYY").day(0).format("MM")-1],r=moment(e,"MMMM DD,YYYY").day(6).format("YYYY");$("#startDate").val(moment(e,"MM/DD/YYYY").day(0).format("MM/DD/YYYY")),$("#endDate").val(moment(e,"MM/DD/YYYY").day(6).format("MM/DD/YYYY")),$("#previousDate").val(moment(e,"MMMM DD,YYYY").day(-1)),$("#nextDate").val(moment(e,"MMMM DD,YYYY").day(7)),$("#month").text(o),$("#dates").text(t+"-"+a),$("#year").text(r),$("#timeEntryId").val(""),timeEntriesData="",$("#btnSave").val("Enter Time"),RemoveControlErrorStyle(),LoadWeekHours(!1,""),DisplayMeetingDivs(),LoadCustomTemplatesWithDefaultData()}catch(n){ShowError("Error loading data.")}}function SelectDate(e){try{HideAllError(),$("#weeklyHours").find(".weekly_day.selected").removeClass("selected"),$("#weekDayName").find(".day_weekly_block.selected").removeClass("selected"),$(e).addClass("selected");var t=$("#weeklyHours").find(".weekly_day.selected").attr("data-value"),a=moment(t).format("dddd"),o=moment(t).format("MMMM"),r=moment(t).format("DD"),n=moment(t).format("YYYY");$("#"+a).addClass("selected"),$("#entriesDayDate").text(a+" "+o+" "+r+", "+n),$("#btnSave").val("Enter Time"),RemoveControlErrorStyle(),LoadTimeEntries(t,t),LoadWeekHoursDetails(),$("#tabTimeEntryDetails").removeClass("active"),$("#tabTimeEntries").addClass("active"),$("#timeEntryDetailsContainer").removeClass("active"),$("#timeEntriesContainer").addClass("active"),$("#timeEntryId").val(""),timeEntriesData="",DisplayMeetingDivs(),LoadCustomTemplatesWithDefaultData()}catch(i){ShowError("Error loading data.")}}var outlookItem;!function(){"use strict";function e(){try{$.get("TimeEntry/TimeEntryHome.html",function(e){var t=outlookItem.itemId;void 0!=outlookItem&&"appointment"==outlookItem.itemType?null===t||void 0==t?outlookItem.start.getAsync(function(t){t.status!=Office.AsyncResultStatus.Failed&&$("#isCalenderEntry").attr("data-date",moment(t.value).format("MM/DD/YYYY")),$("#homePageContainer").html(e),LoadWeekHours(!0,""),LoadTimeEntryViews()}):($("#isCalenderEntry").attr("data-date",moment(outlookItem.start).format("MM/DD/YYYY")),$("#homePageContainer").html(e),LoadWeekHours(!0,""),LoadTimeEntryViews()):($("#homePageContainer").html(e),LoadWeekHours(!0,""),LoadTimeEntryViews())})}catch(e){ShowError("Error loading data.")}}function t(){try{$.get("Login/Login.html",function(e){$("#homePageContainer").html(e)})}catch(e){ShowLoginError("Error loading data.")}}Office.initialize=function(a){$(document).ready(function(){try{app.initialize(),outlookItem=Office.context.mailbox.item,$("#isCalenderEntry").val("appointment"==outlookItem.itemType?!0:!1),$(document).ajaxError(function(e,t,a,o){403==t.status&&window.location.reload()}),$("#homePageContainer").hide(),$("#loadingImageHome").show(),$.ajax({type:"POST",url:gl_ServicePath+"/IsAuthenticated",data:{},contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){var o=jQuery.parseJSON(a.d);o.hasOwnProperty("StatusCode")&&500==o.StatusCode?(t(),ShowLoginError(o.ErrorMessage),$("#homePageContainer").show(),$("#loadingImageHome").hide()):(o?e():t(),$("#homePageContainer").show(),$("#loadingImageHome").hide())},error:function(e){t(),ShowLoginError("Error during authentication."),$("#homePageContainer").show(),$("#loadingImageHome").hide()}})}catch(a){ShowLoginError("Error during authentication.")}})}}();var monthNames=["Jan","Feb","March","April","May","June","July","August","Sep","Oct","Nov","Dec"],Validator;!function(e){var t=/^[A-Z a-z 0-9]+$/,a=/^[0-9.0-9]+$/,o=/\b((1[0-2]|0?[1-9]):([0-5][0-9]) ([AaPp][Mm]))/,r=/^(?:(0[1-9]|1[012])[\/.](0[1-9]|[12][0-9]|3[01])[\/.](19|20)[0-9]{2})$/,n=/^\d{0,2}(\.\d{1,2})?$/,i=function(){function e(){}return e.prototype.isAcceptable=function(e){return void 0==e||""==e.trim()?!1:!0},e}();e.RequiredValidator=i;var l=function(){function e(){}return e.prototype.isAcceptable=function(e){return t.test(e)},e}();e.AlphanumericValidator=l;var d=function(){function e(){}return e.prototype.isAcceptable=function(e){return a.test(e)},e}();e.NumberValidator=d;var m=function(){function e(){}return e.prototype.isAcceptable=function(e){return o.test(e)},e}();e.TimeValidator=m;var s=function(){function e(){}return e.prototype.isAcceptable=function(e){return r.test(e)},e}();e.DateValidator=s;var c=function(){function e(){}return e.prototype.isAcceptable=function(e){return n.test(e)},e}();e.HourValidator=c;var m=function(){function e(){}return e.prototype.isAcceptable=function(e){e=e.replace("am","").replace("AM","").replace("pm","").replace("PM","").trim();var t=e.split(":");return"2"==t.length&&a.test(t[0])&&a.test(t[1])?t[0]>23||t[1]>59?!1:!0:!1},e}();e.TimeValidator=m}(Validator||(Validator={}));